<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>ElevationReader.as</title>
<link rel="stylesheet" type="text/css" href="../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extrusions</span><span class="ActionScriptBracket/Brace">{</span>       <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BitmapData</span>;    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Point</span>;    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Matrix</span>;    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">ElevationReader</span> <span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">channel</span>:<span class="ActionScriptDefault_Text">String</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">levelBmd</span>:<span class="ActionScriptDefault_Text">BitmapData</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">elevate</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">scalingX</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">scalingY</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">buffer</span>:<span class="ActionScriptDefault_Text">Array</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">level</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">offsetX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">offsetY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">smoothness</span>:<span class="ActionScriptDefault_Text">int</span>;                <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_minElevation</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_maxElevation</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 255;                <span class="ActionScriptASDoc">/**        * Locks elevation factor beneath this level. Default is 0;        *        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">minElevation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_minElevation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">val</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">minElevation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_minElevation</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * Locks elevation factor above this level. Default is 255;        *        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">maxElevation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_maxElevation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">val</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">maxElevation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_maxElevation</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * Class generates a traced representation of the elevation geometry, allowing surface tracking to place or move objects on the elevation geometry. &lt;code&gt;ElevationReader&lt;/code&gt;        *         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">ElevationReader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">smoothness</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">buildBuffer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">smoothness</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildBuffer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">smoothness</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">smoothness</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">smoothness</span>;            <span class="ActionScriptDefault_Text">buffer</span> <span class="ActionScriptOperator">=</span> [];            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">smoothness</span>;<span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span>            <span class="ActionScriptDefault_Text">level</span> <span class="ActionScriptOperator">=</span> 0;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * Optional method to be allow the use of a custom (externally) prerendered map.         * @param    sourceBmd        Bitmapdata. The bitmapData to read from.        * @param    channel            [optional] String. The channel information to read. Supported "a", alpha, "r", red, "g", green, "b", blue and "av" (averages and luminance). Default is red channel "r".        * @param    factorX            [optional] Number. The scale multiplier along the x axis. Default is 1.        * @param    factorY            [optional] Number. The scale multiplier along the y axis. Default is 1.        * @param    factorZ            [optional] Number. The scale multiplier along the z axis (the elevation factor). Default is .5.         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setSource</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span>:<span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">channel</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"r"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">factorX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">factorY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">factorZ</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> .5<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">levelBmd</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span>;            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">channel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>;            <span class="ActionScriptDefault_Text">scalingX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">factorX</span>;            <span class="ActionScriptDefault_Text">scalingY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">factorY</span>;            <span class="ActionScriptDefault_Text">elevate</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">factorZ</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptASDoc">/**         * returns the generated bitmapdata, a smooth representation of the geometry.         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">source</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">BitmapData</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">levelBmd</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptASDoc">/**         * returns the generated bitmapdata, a smooth representation of the geometry.         *          * @param    x                The x coordinate on the generated bitmapdata.         * @param    y                The y coordinate on the generated bitmapdata.         * @param    offset            [optional]    the offset that will be added to the elevation value at the x and y coordinates plus the offset. Default = 0.          *         * @return     A Number, the elevation value at the x and y coordinates plus the offset.         */</span>                <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getLevel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">offset</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">col</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">scalingX</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">scalingY</span>;             <span class="ActionScriptDefault_Text">col</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span>.5<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">offsetX</span>;            <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span>.5<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">offsetY</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">col</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">maxElevation</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">maxElevation</span>;            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minElevation</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">minElevation</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">smoothness</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">elevate</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">offset</span>;                        <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">elevate</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">offset</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">shift</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptDefault_Text">level</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;<span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">level</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;            <span class="ActionScriptBracket/Brace">}</span>                        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">level</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * generates the smooth representation of the geometry. uses same parameters as the Elevation class.         *         * @param    sourceBmd                Bitmapdata. The bitmapData to read from.        * @param    channel                    [optional] String. The channel information to read. supported "a", alpha, "r", red, "g", green, "b", blue and "av" (averages and luminance). Default is red channel "r".        * @param    subdivisionX            [optional] int. The subdivision to read the pixels along the x axis. Default is 10.        * @param    subdivisionY            [optional] int. The subdivision to read the pixels along the y axis. Default is 10.        * @param    scalingX                    [optional] Number. The scale multiplier along the x axis. Default is 1.        * @param    scalingY                    [optional] Number. The scale multiplier along the y axis. Default is 1.        * @param    elevate                    [optional] Number. The scale multiplier along the z axis. Default is .5.        *         * @see away3d.extrusions.Elevation        */</span>                <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">traceLevels</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span>:<span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">channel</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"r"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">subdivisionX</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 10<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">subdivisionY</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 10<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">factorX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">factorY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">elevate</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> .5<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">setSource</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">factorX</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">factorY</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">elevate</span><span class="ActionScriptBracket/Brace">)</span>;                         <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">h</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">px1</span>:<span class="ActionScriptDefault_Text">Number</span>;             <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">px2</span>:<span class="ActionScriptDefault_Text">Number</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">px3</span>:<span class="ActionScriptDefault_Text">Number</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">px4</span>:<span class="ActionScriptDefault_Text">Number</span>;                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lockx</span>:<span class="ActionScriptDefault_Text">int</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">locky</span>:<span class="ActionScriptDefault_Text">int</span>;            <span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lock</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">incXL</span>:<span class="ActionScriptDefault_Text">Number</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">incXR</span>:<span class="ActionScriptDefault_Text">Number</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">incYL</span>:<span class="ActionScriptDefault_Text">Number</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">incYR</span>:<span class="ActionScriptDefault_Text">Number</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pxx</span>:<span class="ActionScriptDefault_Text">Number</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pxy</span>:<span class="ActionScriptDefault_Text">Number</span>;                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">+</span>1; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">subdivisionX</span><span class="ActionScriptBracket/Brace">)</span>            <span class="ActionScriptBracket/Brace">{</span>                                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">subdivisionX</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptBracket/Brace">{</span>                    <span class="ActionScriptDefault_Text">offsetX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>.5;                    <span class="ActionScriptDefault_Text">lockx</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>1;                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>                    <span class="ActionScriptDefault_Text">lockx</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">subdivisionX</span>;                <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">+</span>1; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">subdivisionY</span><span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptBracket/Brace">{</span>                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">subdivisionY</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>                    <span class="ActionScriptBracket/Brace">{</span>                        <span class="ActionScriptDefault_Text">offsetY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>.5;                        <span class="ActionScriptDefault_Text">locky</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span>1;                    <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>                        <span class="ActionScriptDefault_Text">locky</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">subdivisionY</span>;                    <span class="ActionScriptBracket/Brace">}</span>                                         <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                        <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"a"</span>:                                <span class="ActionScriptDefault_Text">px1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 24 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 24 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 24 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 24 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"r"</span>:                                <span class="ActionScriptDefault_Text">px1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"g"</span>:                                <span class="ActionScriptDefault_Text">px1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"b"</span>:                                <span class="ActionScriptDefault_Text">px1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"av"</span>:                                <span class="ActionScriptDefault_Text">px1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.212671<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.715160<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.072169<span class="ActionScriptBracket/Brace">)</span>;                                <span class="ActionScriptDefault_Text">px2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.212671<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.715160<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.072169<span class="ActionScriptBracket/Brace">)</span>;                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.212671<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.715160<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.072169<span class="ActionScriptBracket/Brace">)</span>;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.212671<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.715160<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.072169<span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptBracket/Brace">}</span>                                             <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>                                                <span class="ActionScriptDefault_Text">px1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">px4</span>;                        <span class="ActionScriptDefault_Text">px2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">px3</span>;                        <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"a"</span>:                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 24 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 24 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"r"</span>:                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"g"</span>:                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"b"</span>:                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF;                                <span class="ActionScriptReserved">break</span>;                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"av"</span>:                                <span class="ActionScriptDefault_Text">px3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.212671<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.715160<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lockx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.072169<span class="ActionScriptBracket/Brace">)</span>;                                <span class="ActionScriptDefault_Text">px4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.212671<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.715160<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">locky</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xFF<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.072169<span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptBracket/Brace">}</span>                                            <span class="ActionScriptBracket/Brace">}</span>                                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">subdivisionX</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>                    <span class="ActionScriptBracket/Brace">{</span>                        <span class="ActionScriptDefault_Text">incXL</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">subdivisionX</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">k</span>;                        <span class="ActionScriptDefault_Text">incXR</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">incXL</span>;                                                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">subdivisionY</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">)</span>                        <span class="ActionScriptBracket/Brace">{</span>                            <span class="ActionScriptDefault_Text">incYL</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">subdivisionY</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">l</span>;                            <span class="ActionScriptDefault_Text">incYR</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">incYL</span>;                                                        <span class="ActionScriptDefault_Text">pxx</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">px1</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">incXR</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">px2</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">incXL</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">incYR</span>;                            <span class="ActionScriptDefault_Text">pxy</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">px4</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">incXR</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">px3</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">incXL</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">incYL</span>;                                                         <span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setPixel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">pxy</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">pxx</span> <span class="ActionScriptOperator">&lt;&lt;</span> 16 <span class="ActionScriptOperator">|</span>  0xFF<span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pxy</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">pxx</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 8 <span class="ActionScriptOperator">|</span> 0xFF<span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pxy</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">pxx</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;                         <span class="ActionScriptBracket/Brace">}</span>                                             <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptBracket/Brace">}</span>                             <span class="ActionScriptBracket/Brace">}</span>                        <span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">unlock</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * Apply the generated height source to a bitmapdata. The height information is merged to the source creating a smoother look.         *          * @param    src            The bitmapdata that will be merged.         * @param    color            [optional]    The color that will be applied. Note that 32 bits color will allow alpha. 0x88FF0000 defines a red with .5 alpha while 0xFF0000 defines a red with no alpha. Default is .5 alpha black.         * @param    reverse            [optional]    Defines if the color is set using the heightmap from 0-255 or 255-0. Default = true, if a black is used, the darkest are will be at the base of the elevation.           * @param    blendmode            [optional] Blendmode to be applyed in the merge. Possible string values are: lighten, multiply, overlay, screen, substract, add, darken, difference, erase, hardlight, invert and layer.Default = "normal";         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">applyHeightGradient</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span>:<span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0x80000000<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">reverse</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendmode</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"normal"</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">gs</span>:<span class="ActionScriptDefault_Text">BitmapData</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">scl</span>:<span class="ActionScriptDefault_Text">Boolean</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">scl</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;                <span class="ActionScriptDefault_Text">gs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">levelBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sclmat</span>:<span class="ActionScriptDefault_Text">Matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Matrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Wscl</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Hscl</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span>;                <span class="ActionScriptDefault_Text">sclmat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scale</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Wscl</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">Hscl</span><span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sclbmd</span>:<span class="ActionScriptDefault_Text">BitmapData</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Wscl</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Hscl</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> 0x00FFFFFF<span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptDefault_Text">sclbmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">draw</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">sclmat</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"normal"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">sclbmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">gs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">levelBmd</span>;            <span class="ActionScriptBracket/Brace">}</span>                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mskBmd</span>:<span class="ActionScriptDefault_Text">BitmapData</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z</span>:<span class="ActionScriptDefault_Text">Point</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">copyChannel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>8<span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">copyChannel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>8<span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">blendmode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"normal"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">copyPixels</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">draw</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendmode</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span>            <span class="ActionScriptDefault_Text">mskBmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispose</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">scl</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">sclbmd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispose</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptDefault_Text">gs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispose</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptBracket/Brace">}</span>            <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
